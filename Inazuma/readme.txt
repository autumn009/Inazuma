Inazuma Procedural Text Editor
==============================
Version 1.0.0.1
2021年6月19日

　これが超次元エディタだ!

● 概要
　grepなどのコマンドライン・ツールでテキストを編集するための、手続き型のテキストエディタ(Procedural Text Editor)です。

● 機能
　テキストボックスの内容を標準入力とし、任意のコマンドを実行し、標準出力/エラー出力の内容を別のテキストボックスに書き出します。
　入出力データをファイルに書き込むことなく、コマンドラインツールを実行できます。
　grepやsort|uniqをGUIツールと連携するために作成されています。
　(grepなどは付属しません)
　ファイルへの入出力の機能は持っていません。クリップボード経由でテキストを受け取り、クリップボード経由で結果を取り出します。

● 動作環境
Windows 10/.NET 5
(Windows以外では動作しません)

● 基本的な使い方
　メインウィンドウのCommandのテキストボックスに実行する行を入力します。(作業ディレクトリのファイル一覧を得るなら"dir")
　実行する行は、標準入力から入力し(オプション)、標準出力に出力する必要があります。
　もし、レガシーなエンコーディングしか使えないツールを起動する場合は"DEF ENC"にチェックを入れます。
　上側の複数行のテキストボックスに入力テキストを入力し、RUNボタンを押します。すると、下側の複数行のテキストボックスに結果が表示されます。
　もし、上側の複数行のテキストボックスが空の場合は実行に先立ってクリップボードから貼り付けを行います。

● 使用方法・メインウィンドウ
Macro　定義済みのマクロを選択します。選択されたマクロのコマンドラインは、Command欄とDEF ENC欄に入ります。
Command　実行する行を入力します
DEF ENC　システムデフォルトのレガシーエンコーディング(日本ならシフトJIS/CP932)で実行する場合はチェックを入れます。チェックを入れない場合はUTF-8/CP 65001で実行されます)
Edit Macro 定義済みのマクロを編集します。定義済みマクロはこの機能を使わない限り変更されません。(つまり、Command欄は好きなように書き換えても影響は残りません)
Working Dir ワーキングディレクトリ(カレントディレクトリ)を変更します。
Paste Source　上側の複数行のテキストボックスにクリップボードのテキストを貼り付けます
Run↓　コマンドを実行します
Copy Result　下側の複数行のテキストボックスに入っているテキストをクリップボードにコピーします。

● 使用方法・マクロ編集ウィンドウ
Use System Default Legacy Encoding　システムデフォルトのレガシーエンコーディング(日本ならシフトJIS/CP932)を使用する場合はチェックします
Macros 修正するマクロを選択します
Name 名前を入力します
Command 実行するコマンドラインを入力します
Add New Entry　新しいマクロを追加します
Remove Entry　選択されたマクロを削除します
OK　修正を反映してダイアログボックスを閉じます
Cancel　修正を破棄してダイアログボックスを閉じます

● 実装上の制約
　cmd.exe実行時にレジストリを書き換えてデフォルトのコードページを変更しています。変更中に手動でcmd.exeを実行すると通常のデフォルト以外のコードページでcmd.exeが起動します。また本ソフトが強制中断されるとレジストリに一時的な値が残る可能性があります。
　変更するレジストリは、HKEY_CURRENT_USERの"Console\%SystemRoot%_system32_cmd.exe"のCodePageサブキーの値です。
　また、構造上、標準入力にリダイレクトされないキー入力待ちのあるコマンドを実行するとハングします。
　入出力のテキストボックスの容量の制約からあまり大きなデータは扱えません。

● ソースコード
　ソースコードはgithubで全て公開されています。
https://github.com/autumn009/Inazuma

● サポート
Twitter @KawamataAkira
電子メール autumn@piedey.co.jp
川俣晶宛にお問い合わせ下さい

● ライセンス
MIT License (Open Source)

● 改訂履歴
1.0.0.1　2021年6月19日　最初のリリース

以上
